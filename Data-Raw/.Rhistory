ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( )
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA > AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA > AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB > AgeDxC ), paste0( CATYPEC ),
ifelse( )
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
l
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA > AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA > AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB > AgeDxC ), paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX""AgeDxA","AgeDxB","AgeDxC")])
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX""AgeDxA","AgeDxB","AgeDxC")])
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC")])
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC")])
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC","RIDAGEYR")])
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC","RIDAGEYR")])
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin' & is.na(AgeDxB)==T, paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC","RIDAGEYR")])
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin' & is.na(AgeDxB)==T, paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC","RIDAGEYR")])
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC","RIDAGEYR",'SEQN')])
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( SEQN == 66141, paste0( CATYPEA ), #individual fix
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC","RIDAGEYR",'SEQN')])
tyr[which(tyr$SEQN==66141),]
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
ifelse( SEQN == 66141, paste0( CATYPEA ), #individual fix
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC","RIDAGEYR",'SEQN')])
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeSinceCADx = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', RIDAGEYR - AgeDxC,
TimeSinceCADx ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
tyr <- mcqall.bc%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ) ) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeSinceCADx = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', RIDAGEYR - AgeDxC,
TimeSinceCADX ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) )
View(tyr[which(is.na(tyr$PrimaryCA)==T & tyr$CA==1),c("CATYPEA","CATYPEB","CATYPEC","TimeSinceCADX","AgeDxA","AgeDxB","AgeDxC","RIDAGEYR",'SEQN')])
table(tyr$PrimaryCA)
View(tyr[which(tyr$PrimaryCA=='Non-Melanoma Skin')])
View(tyr[which(tyr$PrimaryCA=='Non-Melanoma Skin'),])
tyr <- mcqall.bc%>%
mutate(   AgeDxAmn = AgeDxA*12 ,
AgeDxBmn = AgeDxB*12 ,
AgeDxCmn = AgeDxC*12 ,)
tyr <- mcqall.bc%>%
tyr <- mcqall.bc%>%
tyr <- mcqall.bc%>%
tyr <- mcqall.bc%>%
mutate(   AgeDxAmn = AgeDxA*12 ,
AgeDxBmn = AgeDxB*12 ,
AgeDxCmn = AgeDxC*12 )%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ),
TimeSinceCADXmn = ifelse( is.na( AgeDxAmn ) == T & is.na( AgeDxBmn ) == T & is.na( AgeDxCmn ) == T, NA,
ifelse( CA == 1, RIDAGEMN-min( c( AgeDxAmn, AgeDxBmn, AgeDxCmn ),  na.rm = TRUE ), NA ) )) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeSinceCADX = ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', RIDAGEYR - AgeDxC,
TimeSinceCADX ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeSinceCADXmn = ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin', RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin', RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxBmn <= AgeDxCmn ), RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxAmn <= AgeDxCmn ), RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxCmn ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxAmn <= AgeDxBmn ), RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxCmn ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxAmn >= AgeDxBmn ), RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxAmn <= AgeDxCmn ), RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxAmn >= AgeDxCmn ), RIDAGEMN - AgeDxCmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxBmn <= AgeDxCmn ), RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxBmn >= AgeDxCmn ), RIDAGEMN - AgeDxCmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxCmn ) & CATYPEC != 'Non-Melanoma Skin', RIDAGEMN - AgeDxCmn,
TimeSinceCADXmn ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeCAFactor = as.factor( ifelse( TimeSinceCADX < 2,  '2< years',
ifelse( TimeSinceCADX >= 2 & TimeSinceCADX < 6, '>= 2 and <6 years',
ifelse( TimeSinceCADX >= 6,  '>= 6 years', NA ) ) ) ) ,
TimeCAFactormn = as.factor( ifelse( TimeSinceCADXmn < 24,  '2< years',
ifelse( TimeSinceCADXmn >= 24 & TimeSinceCADXmn<72, '>= 2 and <6 years',
ifelse( TimeSinceCADXmn >= 72,  '>= 6 years', NA ) ) ) ),
TimeSinceCADXmn = ifelse( TimeSinceCADXmn < 0, NA, TimeSinceCADXmn ) ,
TimeCAFactormn = ifelse( TimeSinceCADXmn < 0, NA, as.character( TimeCAFactormn ) ) ,
TimeSinceCADX = ifelse( TimeSinceCADX < 0, NA, TimeSinceCADX ) ,
TimeCAFactor = factor( ifelse( TimeSinceCADX < 0, NA, as.character( TimeCAFactor ) ) ) )
tyr <- mcqall.bc%>%
mutate(   AgeDxAmn = AgeDxA*12 ,
AgeDxBmn = AgeDxB*12 ,
AgeDxCmn = AgeDxC*12 )%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ),
TimeSinceCADXmn = ifelse( is.na( AgeDxAmn ) == T & is.na( AgeDxBmn ) == T & is.na( AgeDxCmn ) == T, NA,
ifelse( CA == 1, RIDAGEMN-min( c( AgeDxAmn, AgeDxBmn, AgeDxCmn ),  na.rm = TRUE ), NA ) )) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeSinceCADX = ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', RIDAGEYR - AgeDxC,
TimeSinceCADX ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeSinceCADXmn = ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin', RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin', RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxBmn <= AgeDxCmn ), RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxAmn <= AgeDxCmn ), RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxCmn ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxAmn <= AgeDxBmn ), RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxCmn ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxAmn >= AgeDxBmn ), RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxAmn <= AgeDxCmn ), RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxAmn >= AgeDxCmn ), RIDAGEMN - AgeDxCmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxBmn <= AgeDxCmn ), RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxBmn >= AgeDxCmn ), RIDAGEMN - AgeDxCmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxCmn ) & CATYPEC != 'Non-Melanoma Skin', RIDAGEMN - AgeDxCmn,
TimeSinceCADXmn ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeCAFactor = as.factor( ifelse( TimeSinceCADX < 2,  '2< years',
ifelse( TimeSinceCADX >= 2 & TimeSinceCADX < 6, '>= 2 and <6 years',
ifelse( TimeSinceCADX >= 6,  '>= 6 years', NA ) ) ) ) ,
TimeCAFactormn = as.factor( ifelse( TimeSinceCADXmn < 24,  '2< years',
ifelse( TimeSinceCADXmn >= 24 & TimeSinceCADXmn<72, '>= 2 and <6 years',
ifelse( TimeSinceCADXmn >= 72,  '>= 6 years', NA ) ) ) ),
TimeSinceCADXmn = ifelse( TimeSinceCADXmn < 0, NA, TimeSinceCADXmn ) ,
TimeCAFactormn = ifelse( TimeSinceCADXmn < 0, NA, as.character( TimeCAFactormn ) ) ,
TimeSinceCADX = ifelse( TimeSinceCADX < 0, NA, TimeSinceCADX ) ,
TimeCAFactor = factor( ifelse( TimeSinceCADX < 0, NA, as.character( TimeCAFactor ) ) ) )
table(tyr$PrimaryCA)
View(tyr[which(tyr$PrimaryCA=='Non-Melanoma Skin'),])
# CREATE VARIABLES
mcqall.bcd <- mcqall.bc%>%
mutate(   AgeDxAmn = AgeDxA*12 ,
AgeDxBmn = AgeDxB*12 ,
AgeDxCmn = AgeDxC*12 )%>%
rowwise(  )%>%
mutate( RIDAGEMN = ifelse( is.na( RIDAGEMN ) == T, RIDAGEYR*12, RIDAGEMN ),
TimeSinceCADX = ifelse( is.na( AgeDxA ) == T & is.na( AgeDxB ) == T & is.na( AgeDxC ) == T, NA,
ifelse( CA == 1, RIDAGEYR-min( c( AgeDxA, AgeDxB, AgeDxC ),  na.rm = TRUE ), NA ) ),
TimeSinceCADXmn = ifelse( is.na( AgeDxAmn ) == T & is.na( AgeDxBmn ) == T & is.na( AgeDxCmn ) == T, NA,
ifelse( CA == 1, RIDAGEMN-min( c( AgeDxAmn, AgeDxBmn, AgeDxCmn ),  na.rm = TRUE ), NA ) )) %>%
ungroup() %>%
mutate( PrimaryCA = factor( as.character( ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, paste0(  CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), paste0( CATYPEC ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', paste0( CATYPEA ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', paste0( CATYPEB ),
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', paste0( CATYPEC ),
NA ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeSinceCADX = ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxB ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxB ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA <= AgeDxC ), RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxA >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB <= AgeDxC ), RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxB >= AgeDxC ), RIDAGEYR - AgeDxC,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxA ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEYR - AgeDxA,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxB ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEYR - AgeDxB,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADX==RIDAGEYR-AgeDxC ) & CATYPEC != 'Non-Melanoma Skin', RIDAGEYR - AgeDxC,
TimeSinceCADX ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeSinceCADXmn = ifelse( is.na ( CATYPEA )==F & is.na ( CATYPEB )==T & is.na ( CATYPEC )==T, RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin', RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==T ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin', RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxBmn <= AgeDxCmn ), RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxAmn <= AgeDxCmn ), RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxCmn ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxAmn <= AgeDxBmn ), RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxCmn ) & CATYPEC == 'Non-Melanoma Skin' & ( AgeDxAmn >= AgeDxBmn ), RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxAmn <= AgeDxCmn ), RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB == 'Non-Melanoma Skin' & ( AgeDxAmn >= AgeDxCmn ), RIDAGEMN - AgeDxCmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxBmn <= AgeDxCmn ), RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA == 'Non-Melanoma Skin' & ( AgeDxBmn >= AgeDxCmn ), RIDAGEMN - AgeDxCmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxAmn ) & CATYPEA != 'Non-Melanoma Skin', RIDAGEMN - AgeDxAmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxBmn ) & CATYPEB != 'Non-Melanoma Skin', RIDAGEMN - AgeDxBmn,
ifelse( (is.na ( CATYPEA )==F & is.na ( CATYPEB )==F & is.na ( CATYPEC )==F ) & ( TimeSinceCADXmn==RIDAGEMN-AgeDxCmn ) & CATYPEC != 'Non-Melanoma Skin', RIDAGEMN - AgeDxCmn,
TimeSinceCADXmn ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ),
TimeCAFactor = as.factor( ifelse( TimeSinceCADX < 2,  '2< years',
ifelse( TimeSinceCADX >= 2 & TimeSinceCADX < 6, '>= 2 and <6 years',
ifelse( TimeSinceCADX >= 6,  '>= 6 years', NA ) ) ) ) ,
TimeCAFactormn = as.factor( ifelse( TimeSinceCADXmn < 24,  '2< years',
ifelse( TimeSinceCADXmn >= 24 & TimeSinceCADXmn<72, '>= 2 and <6 years',
ifelse( TimeSinceCADXmn >= 72,  '>= 6 years', NA ) ) ) ),
TimeSinceCADXmn = ifelse( TimeSinceCADXmn < 0, NA, TimeSinceCADXmn ) ,
TimeCAFactormn = ifelse( TimeSinceCADXmn < 0, NA, as.character( TimeCAFactormn ) ) ,
TimeSinceCADX = ifelse( TimeSinceCADX < 0, NA, TimeSinceCADX ) ,
TimeCAFactor = factor( ifelse( TimeSinceCADX < 0, NA, as.character( TimeCAFactor ) ) ) )
